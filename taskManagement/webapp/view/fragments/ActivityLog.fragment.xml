<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
>
    <Panel
        headerText="{i18n>title.activityLog}"
        expandable="true"
        expanded="true"
    >
        <content>
            <VBox>
                <!-- Filter Bar -->
                <Toolbar>
                    <SearchField
                        id="activitySearchField"
                        width="60%"
                        placeholder="{i18n>placeholder.searchActivities}"
                        value="{filterModel>/searchQuery}"
                        search=".onActivitySearch"
                        liveChange=".onActivitySearch"
                    />
                    <ToolbarSpacer />
                    <Select
                        id="activityTypeFilter"
                        width="150px"
                        selectedKey="{filterModel>/typeFilter}"
                        change=".onActivityFilterChange"
                    >
                        <items>
                            <core:Item key="all" text="{i18n>filter.allActions}"/>
                            <core:Item key="APPROVED" text="{i18n>filter.status.approved}"/>
                            <core:Item key="REJECTED" text="{i18n>filter.status.rejected}"/>
                            <core:Item key="PARTIALLY_REJECTED" text="{i18n>filter.status.partiallyRejected}"/>
                            <core:Item key="SUBMITTED" text="{i18n>filter.status.submitted}"/>
                        </items>
                    </Select>
                </Toolbar>

                <!-- Activity Feed -->
                <List
                    class="activityLogList"
                    id="activityFeedList"
                    items="{dashboardModel>/activitiesFiltered}"
                    growing="true"
                    growingThreshold="20"
                    noDataText="{i18n>text.noActivities}"
                >
                    <FeedListItem
                        sender="{dashboardModel>actorName}"
                        icon="{path: 'dashboardModel>action', formatter: '.formatter.getRequestTypeIcon'}"
                        iconActive="false"
                        info="{dashboardModel>requestType}"
                        timestamp="{path: 'dashboardModel>timestamp', formatter: '.formatter.formatDateTime'}"
                        text="{dashboardModel>description}"
                        press=".onActivityPress"
                    >
                        <customData>
                            <core:CustomData
                                key="requestId"
                                value="{dashboardModel>requestId}"
                            />
                            <core:CustomData
                                key="requestType"
                                value="{dashboardModel>requestType}"
                            />
                        </customData>
                    </FeedListItem>
                </List>
            </VBox>
        </content>
    </Panel>
</core:FragmentDefinition>

